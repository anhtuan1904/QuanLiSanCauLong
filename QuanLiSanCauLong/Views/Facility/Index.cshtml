@model IEnumerable<QuanLiSanCauLong.ViewModels.FacilityCardViewModel>
@{
    ViewData["Title"] = "Danh sách sân cầu lông";
}

<link href="https://fonts.googleapis.com/css2?family=Anton&family=DM+Serif+Display:ital@0;1&family=Karla:ital,wght@0,300;0,400;0,500;0,700;1,300&display=swap" rel="stylesheet">

<style>
    :root {
        --cream: #f7f3ec;
        --ink: #1a1714;
        --rust: #c94b2a;
        --sand: #e8ddd0;
        --sage: #4a6741;
        --muted: #8c8278;
        --white: #fdfcfa;
        --border: #d4ccc0;
    }

    * {
        box-sizing: border-box;
    }

    .facility-page {
        background: var(--cream);
        font-family: 'Karla', sans-serif;
        color: var(--ink);
        min-height: 100vh;
    }

    /* ── HERO ─────────────────────────────────────── */
    .fac-hero {
        display: grid;
        grid-template-columns: 1fr 380px;
        min-height: 75vh;
        background: var(--ink);
        overflow: hidden;
        position: relative;
    }

    .fac-hero-left {
        padding: 5rem 5rem 4rem;
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        position: relative;
        z-index: 2;
    }

    .eyebrow-row {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 2.5rem;
    }

    .eyebrow-pill {
        background: var(--rust);
        color: #fff;
        font-family: 'Karla', sans-serif;
        font-size: .7rem;
        font-weight: 700;
        letter-spacing: .18em;
        text-transform: uppercase;
        padding: .35rem 1rem;
        border-radius: 2px;
    }

    .eyebrow-line {
        flex: 1;
        height: 1px;
        background: rgba(255,255,255,.1);
        max-width: 60px;
    }

    .hero-headline {
        margin-bottom: 2rem;
    }

    .h-line1 {
        font-family: 'DM Serif Display', serif;
        font-style: italic;
        font-size: clamp(2.5rem, 5vw, 5rem);
        color: rgba(255,255,255,.35);
        line-height: 1;
        display: block;
    }

    .h-line2 {
        font-family: 'Anton', sans-serif;
        font-size: clamp(4rem, 9vw, 9.5rem);
        line-height: .9;
        color: var(--white);
        letter-spacing: -.02em;
        display: block;
    }

    .h-line3 {
        font-family: 'Anton', sans-serif;
        font-size: clamp(4rem, 9vw, 9.5rem);
        line-height: .9;
        color: var(--rust);
        letter-spacing: -.02em;
        display: block;
    }

    .hero-meta {
        display: flex;
        gap: 3rem;
        padding-top: 2.5rem;
        border-top: 1px solid rgba(255,255,255,.08);
    }

    .hmeta-item {
    }

    .hmeta-n {
        font-family: 'Anton', sans-serif;
        font-size: 2.5rem;
        line-height: 1;
        color: var(--white);
    }

    .hmeta-l {
        font-size: .75rem;
        letter-spacing: .12em;
        text-transform: uppercase;
        color: rgba(255,255,255,.35);
        margin-top: .3rem;
    }

    .fac-hero-right {
        position: relative;
        overflow: hidden;
    }

        .fac-hero-right img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: grayscale(40%) sepia(10%) contrast(1.05);
            opacity: .7;
            mix-blend-mode: luminosity;
        }

        .fac-hero-right::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to right, var(--ink) 0%, transparent 40%);
            z-index: 1;
        }

    /* ── SEARCH BAR ───────────────────────────────── */
    .search-strip {
        background: var(--rust);
        padding: 1.8rem 5rem;
        display: flex;
        align-items: center;
        gap: 1.5rem;
    }

    .search-field-wrap {
        flex: 1;
        max-width: 480px;
        display: flex;
        background: rgba(255,255,255,.15);
        border: 1px solid rgba(255,255,255,.25);
        overflow: hidden;
    }

    .search-field {
        flex: 1;
        background: none;
        border: none;
        padding: .85rem 1.2rem;
        color: #fff;
        font-family: 'Karla', sans-serif;
        font-size: .9rem;
        outline: none;
    }

        .search-field::placeholder {
            color: rgba(255,255,255,.55);
        }

    .search-submit {
        background: var(--ink);
        border: none;
        color: #fff;
        padding: .85rem 1.4rem;
        cursor: pointer;
        font-size: .95rem;
        transition: background .2s;
    }

        .search-submit:hover {
            background: #000;
        }

    .city-select {
        background: rgba(255,255,255,.15);
        border: 1px solid rgba(255,255,255,.25);
        color: #fff;
        padding: .85rem 1.2rem;
        font-family: 'Karla', sans-serif;
        font-size: .88rem;
        outline: none;
        cursor: pointer;
        min-width: 200px;
    }

        .city-select option {
            background: var(--ink);
            color: #fff;
        }

    .search-strip-count {
        font-family: 'Anton', sans-serif;
        font-size: 1.4rem;
        color: rgba(255,255,255,.6);
        letter-spacing: .03em;
        margin-left: auto;
        white-space: nowrap;
    }

        .search-strip-count span {
            color: #fff;
        }

    /* ── FILTER PILLS ─────────────────────────────── */
    .filter-row {
        background: var(--white);
        border-bottom: 2px solid var(--border);
        padding: 1rem 5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        overflow-x: auto;
        scrollbar-width: none;
    }

        .filter-row::-webkit-scrollbar {
            display: none;
        }

    .filter-label {
        font-size: .72rem;
        font-weight: 700;
        letter-spacing: .15em;
        text-transform: uppercase;
        color: var(--muted);
        white-space: nowrap;
        flex-shrink: 0;
    }

    .fpill {
        padding: .45rem 1.2rem;
        border: 1.5px solid var(--border);
        background: none;
        font-family: 'Karla', sans-serif;
        font-size: .82rem;
        font-weight: 700;
        color: var(--muted);
        cursor: pointer;
        border-radius: 2px;
        transition: all .2s;
        white-space: nowrap;
        flex-shrink: 0;
    }

        .fpill:hover {
            border-color: var(--ink);
            color: var(--ink);
        }

        .fpill.active {
            background: var(--ink);
            color: #fff;
            border-color: var(--ink);
        }

    /* ── FACILITY GRID ────────────────────────────── */
    .fac-grid-wrap {
        padding: 4rem 5rem;
        max-width: 1600px;
        margin: 0 auto;
    }

    .grid-header {
        display: flex;
        align-items: baseline;
        justify-content: space-between;
        margin-bottom: 3rem;
    }

    .grid-title {
        font-family: 'DM Serif Display', serif;
        font-style: italic;
        font-size: 2.5rem;
        color: var(--ink);
    }

    .sort-row {
        display: flex;
        gap: .75rem;
    }

    .sort-btn {
        padding: .5rem 1.1rem;
        border: 1.5px solid var(--border);
        background: none;
        font-size: .78rem;
        font-weight: 700;
        color: var(--muted);
        cursor: pointer;
        border-radius: 2px;
        transition: all .2s;
        font-family: 'Karla', sans-serif;
        letter-spacing: .05em;
    }

        .sort-btn:hover, .sort-btn.active {
            border-color: var(--ink);
            color: var(--ink);
        }

    .fac-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1px;
        background: var(--border);
    }

    /* ── FACILITY CARD ────────────────────────────── */
    .fac-card {
        background: var(--white);
        cursor: pointer;
        display: flex;
        flex-direction: column;
        position: relative;
        overflow: hidden;
        transition: all .3s;
    }

        .fac-card::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            width: 0;
            background: var(--rust);
            transition: width .4s cubic-bezier(.25,.46,.45,.94);
        }

        .fac-card:hover {
            background: var(--ink);
        }

            .fac-card:hover::after {
                width: 100%;
            }

    .fac-img {
        height: 240px;
        overflow: hidden;
        position: relative;
        background: var(--sand);
        flex-shrink: 0;
    }

        .fac-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform .6s cubic-bezier(.25,.46,.45,.94);
            filter: saturate(.9);
        }

    .fac-card:hover .fac-img img {
        transform: scale(1.06);
        filter: saturate(.7) brightness(.85);
    }

    .no-fac-img {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--sand);
    }

        .no-fac-img i {
            font-size: 4rem;
            color: var(--border);
        }

    .rating-chip {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: var(--white);
        font-family: 'Anton', sans-serif;
        font-size: .95rem;
        letter-spacing: .03em;
        color: var(--ink);
        padding: .35rem .8rem;
        display: flex;
        align-items: center;
        gap: .3rem;
    }

        .rating-chip i {
            color: #f59e0b;
            font-size: .8rem;
        }

    .court-badge {
        position: absolute;
        bottom: 1rem;
        left: 1rem;
        background: var(--sage);
        color: #fff;
        font-size: .68rem;
        font-weight: 700;
        letter-spacing: .12em;
        text-transform: uppercase;
        padding: .25rem .75rem;
        font-family: 'Karla', sans-serif;
    }

    .fac-body {
        padding: 2rem;
        flex: 1;
        display: flex;
        flex-direction: column;
        transition: background .3s;
    }

    .fac-name {
        font-family: 'Anton', sans-serif;
        font-size: 1.5rem;
        line-height: 1.1;
        letter-spacing: .01em;
        color: var(--ink);
        margin-bottom: 1rem;
        transition: color .3s;
    }

    .fac-card:hover .fac-name {
        color: var(--white);
    }

    .fac-info-row {
        display: flex;
        gap: 1.5rem;
        margin-bottom: 1.5rem;
        flex-wrap: wrap;
    }

    .fac-info-item {
        display: flex;
        align-items: center;
        gap: .5rem;
        font-size: .82rem;
        font-weight: 300;
        color: var(--muted);
        transition: color .3s;
    }

    .fac-card:hover .fac-info-item {
        color: rgba(255,255,255,.45);
    }

    .fac-info-item i {
        font-size: .9rem;
    }

    .fac-footer {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-top: auto;
        padding-top: 1.5rem;
        border-top: 1px solid var(--border);
        transition: border-color .3s;
    }

    .fac-card:hover .fac-footer {
        border-color: rgba(255,255,255,.1);
    }

    .fac-price-wrap {
    }

    .fac-price {
        font-family: 'Anton', sans-serif;
        font-size: 1.8rem;
        line-height: 1;
        color: var(--ink);
        transition: color .3s;
    }

    .fac-card:hover .fac-price {
        color: var(--rust);
    }

    .fac-price-unit {
        font-size: .72rem;
        letter-spacing: .1em;
        text-transform: uppercase;
        color: var(--muted);
        margin-top: .25rem;
        transition: color .3s;
    }

    .fac-card:hover .fac-price-unit {
        color: rgba(255,255,255,.3);
    }

    .fac-btn {
        display: flex;
        align-items: center;
        gap: .5rem;
        background: none;
        border: 1.5px solid var(--border);
        padding: .65rem 1.2rem;
        font-family: 'Karla', sans-serif;
        font-size: .78rem;
        font-weight: 700;
        letter-spacing: .08em;
        text-transform: uppercase;
        cursor: pointer;
        text-decoration: none;
        color: var(--ink);
        transition: all .3s;
        border-radius: 2px;
    }

    .fac-card:hover .fac-btn {
        background: var(--rust);
        border-color: var(--rust);
        color: #fff;
    }

    /* ── EMPTY STATE ──────────────────────────────── */
    .fac-empty {
        grid-column: 1 / -1;
        background: var(--white);
        padding: 6rem;
        text-align: center;
    }

    .fac-empty-head {
        font-family: 'Anton', sans-serif;
        font-size: 4rem;
        color: var(--border);
        margin-bottom: 1rem;
    }

    .fac-empty p {
        color: var(--muted);
        font-size: .95rem;
    }

    /* ── RESPONSIVE ───────────────────────────────── */
    @@media (max-width: 1100px) {
        .fac-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .fac-grid-wrap {
            padding: 3rem 2rem;
        }

        .search-strip, .filter-row {
            padding-left: 2rem;
            padding-right: 2rem;
        }

        .fac-hero {
            grid-template-columns: 1fr;
            min-height: auto;
        }

        .fac-hero-right {
            display: none;
        }

        .fac-hero-left {
            padding: 4rem 2rem 3rem;
        }
    }
    @@media (max-width: 700px) {
        .fac-grid {
            grid-template-columns: 1fr;
        }

        .search-strip {
            flex-wrap: wrap;
            gap: 1rem;
            padding: 1.2rem 1.5rem;
        }

        .search-strip-count {
            display: none;
        }

        .h-line2, .h-line3 {
            font-size: 4rem;
        }

        .hmeta-n {
            font-size: 1.8rem;
        }
    }
</style>

<div class="facility-page">

    <!-- HERO -->
    <section class="fac-hero">
        <div class="fac-hero-left">
            <div class="eyebrow-row">
                <div class="eyebrow-pill">Badminton Courts</div>
                <div class="eyebrow-line"></div>
            </div>
            <div class="hero-headline">
                <span class="h-line1">Tìm kiếm</span>
                <span class="h-line2">SÂN</span>
                <span class="h-line3">ĐẶT</span>
                <span class="h-line2" style="color: rgba(255,255,255,.25); font-size: clamp(2rem, 4vw, 4.5rem);">NGAY HÔM NAY.</span>
            </div>
            <div class="hero-meta">
                <div class="hmeta-item">
                    <div class="hmeta-n">@Model.Count()</div>
                    <div class="hmeta-l">Sân khả dụng</div>
                </div>
                <div class="hmeta-item">
                    <div class="hmeta-n">@(ViewBag.Cities != null ? ((IEnumerable<string>)ViewBag.Cities).Count() : 0)+</div>
                    <div class="hmeta-l">Khu vực</div>
                </div>
                <div class="hmeta-item">
                    <div class="hmeta-n">5★</div>
                    <div class="hmeta-l">Đánh giá</div>
                </div>
            </div>
        </div>
        <div class="fac-hero-right">
            <img src="https://images.unsplash.com/photo-1613918431703-aa50889e3be8?w=800&q=80" alt="Badminton court" />
        </div>
    </section>

    <!-- SEARCH STRIP -->
    <form asp-action="Index" method="get">
        <div class="search-strip">
            <div class="search-field-wrap">
                <input type="text" name="search" class="search-field"
                       placeholder="Tìm theo tên sân, quận, địa chỉ..."
                       value="@ViewBag.SearchTerm" />
                <button type="submit" class="search-submit">
                    <i class="bi bi-search"></i>
                </button>
            </div>
            <select name="city" class="city-select">
                <option value="">Tất cả khu vực</option>
                @if (ViewBag.Cities != null)
                {
                    foreach (var city in (IEnumerable<string>)ViewBag.Cities)
                    {
                        <option value="@city" selected="@(ViewBag.SelectedCity?.ToString() == city)">@city</option>
                    }
                }
            </select>
            <div class="search-strip-count">
                <span>@Model.Count()</span> sân được tìm thấy
            </div>
        </div>
    </form>

    <!-- FILTER ROW -->
    <div class="filter-row">
        <span class="filter-label">Lọc theo:</span>
        <button class="fpill active" data-district="all">Tất cả</button>
        <button class="fpill" data-district="Quận 1">Quận 1</button>
        <button class="fpill" data-district="Quận 3">Quận 3</button>
        <button class="fpill" data-district="Quận 7">Quận 7</button>
        <button class="fpill" data-district="Quận 10">Quận 10</button>
        <button class="fpill" data-district="Phú Nhuận">Phú Nhuận</button>
        <button class="fpill" data-district="Tân Bình">Tân Bình</button>
        <button class="fpill" data-district="Bình Thạnh">Bình Thạnh</button>
        <button class="fpill" data-district="Gò Vấp">Gò Vấp</button>
    </div>

    <!-- GRID -->
    <div class="fac-grid-wrap">
        <div class="grid-header">
            <div class="grid-title">Danh sách sân</div>
            <div class="sort-row">
                <button class="sort-btn active">Mặc định</button>
                <button class="sort-btn" id="sortPrice">↑ Giá</button>
                <button class="sort-btn" id="sortRating">★ Đánh giá</button>
            </div>
        </div>

        <div class="fac-grid" id="facilityGrid">
            @if (!Model.Any())
            {
                <div class="fac-empty">
                    <div class="fac-empty-head">Không<br />tìm thấy</div>
                    <p>Thử tìm kiếm với từ khóa khác hoặc mở rộng khu vực tìm kiếm.</p>
                </div>
            }
            else
            {
                @foreach (var item in Model)
                {
                    <div class="fac-card" data-district="@item.District" data-price="100000">
                        <div class="fac-img">
                            @if (!string.IsNullOrEmpty(item.ImageUrl))
                            {
                                <img src="@item.ImageUrl" alt="@item.FacilityName" />
                            }
                            else
                            {
                                <div class="no-fac-img"><i class="bi bi-building"></i></div>
                            }
                            <div class="rating-chip"><i class="bi bi-star-fill"></i> 4.8</div>
                            <div class="court-badge"><i class="bi bi-check-circle me-1"></i>Sẵn sàng</div>
                        </div>
                        <div class="fac-body">
                            <div class="fac-name">@item.FacilityName</div>
                            <div class="fac-info-row">
                                <div class="fac-info-item">
                                    <i class="bi bi-geo-alt-fill text-danger"></i>
                                    @item.District
                                </div>
                                <div class="fac-info-item">
                                    <i class="bi bi-clock"></i>
                                    @item.OpenTime?.ToString(@"hh\:mm") – @item.CloseTime?.ToString(@"hh\:mm")
                                </div>
                            </div>
                            <div class="fac-footer">
                                <div class="fac-price-wrap">
                                    <div class="fac-price">100.000đ</div>
                                    <div class="fac-price-unit">/ giờ / sân</div>
                                </div>
                                <a asp-action="Details" asp-route-id="@item.FacilityId" class="fac-btn">
                                    Đặt sân <i class="bi bi-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                }
            }
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // District filter pills
        document.querySelectorAll('.fpill').forEach(pill => {
            pill.addEventListener('click', function() {
                document.querySelectorAll('.fpill').forEach(p => p.classList.remove('active'));
                this.classList.add('active');
                const dist = this.dataset.district;
                document.querySelectorAll('.fac-card').forEach(card => {
                    card.style.display = (dist === 'all' || card.dataset.district === dist) ? '' : 'none';
                });
            });
        });

        // Sort buttons
        document.querySelectorAll('.sort-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            });
        });
    </script>
}
