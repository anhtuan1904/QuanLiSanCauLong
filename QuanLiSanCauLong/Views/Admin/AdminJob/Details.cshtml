@model QuanLiSanCauLong.Models.JobPosting
@{
    Layout = null;
}

<div class="modal-header border-0 px-4 pt-4 pb-0">
    <div>
        <h5 class="fw-bold mb-1">Chi Tiết Tin Tuyển Dụng</h5>
        <p class="text-muted small mb-0">Thông tin đầy đủ về vị trí tuyển dụng</p>
    </div>
    <button type="button" class="btn-close shadow-none" data-bs-dismiss="modal"></button>
</div>

<div class="modal-body px-4 py-3">
    <div class="job-details">
        <!-- Header -->
        <div class="bg-light rounded-3 p-4 mb-4">
            <h4 class="fw-bold mb-3">@Model.JobTitle</h4>
            <div class="d-flex flex-wrap gap-2 mb-3">
                <span class="badge bg-@(Model.Status == "Open" ? "success" : "secondary") px-3 py-2">
                    @(Model.Status == "Open" ? "Đang tuyển" : (Model.Status == "Filled" ? "Đã tuyển đủ" : "Đã đóng"))
                </span>
                @if (Model.IsFeatured)
                {
                    <span class="badge bg-warning text-dark px-3 py-2"><i class="bi bi-star-fill me-1"></i>Nổi bật</span>
                }
            </div>
            <div class="row g-3">
                <div class="col-md-6">
                    <small class="text-muted d-block">Loại hình</small>
                    <strong>@Model.JobType</strong>
                </div>
                <div class="col-md-6">
                    <small class="text-muted d-block">Cấp bậc</small>
                    <strong>@Model.Level</strong>
                </div>
                <div class="col-md-6">
                    <small class="text-muted d-block">Số lượng tuyển</small>
                    <strong>@Model.VacancyCount vị trí</strong>
                </div>
                <div class="col-md-6">
                    <small class="text-muted d-block">Địa điểm</small>
                    <strong>@Model.Location</strong>
                </div>
            </div>
        </div>

        <!-- Salary -->
        @if (Model.SalaryMin.HasValue || Model.SalaryMax.HasValue)
        {
            <div class="mb-4">
                <h6 class="fw-bold mb-2">💰 Mức Lương</h6>
                <div class="bg-success bg-opacity-10 rounded-3 p-3">
                    <div class="fs-5 fw-bold text-success">
                        @if (Model.SalaryMin.HasValue && Model.SalaryMax.HasValue)
                        {
                            <span>@Model.SalaryMin.Value.ToString("N0")đ - @Model.SalaryMax.Value.ToString("N0")đ</span>
                        }
                        else if (Model.SalaryMin.HasValue)
                        {
                            <span>Từ @Model.SalaryMin.Value.ToString("N0")đ</span>
                        }
                        else
                        {
                            <span>Lên đến @Model.SalaryMax.Value.ToString("N0")đ</span>
                        }
                    </div>
                </div>
            </div>
        }

        <!-- Description -->
        <div class="mb-4">
            <h6 class="fw-bold mb-2">📝 Mô Tả Công Việc</h6>
            <div class="text-secondary" style="white-space: pre-wrap;">@Model.JobDescription</div>
        </div>

        <!-- Requirements -->
        @if (!string.IsNullOrEmpty(Model.Requirements))
        {
            <div class="mb-4">
                <h6 class="fw-bold mb-2">✅ Yêu Cầu</h6>
                <div class="text-secondary" style="white-space: pre-wrap;">@Model.Requirements</div>
            </div>
        }

        <!-- Benefits -->
        @if (!string.IsNullOrEmpty(Model.Benefits))
        {
            <div class="mb-4">
                <h6 class="fw-bold mb-2">🎁 Quyền Lợi</h6>
                <div class="text-secondary" style="white-space: pre-wrap;">@Model.Benefits</div>
            </div>
        }

        <!-- Contact -->
        <div class="mb-4">
            <h6 class="fw-bold mb-2">📞 Liên Hệ</h6>
            <div class="row g-2">
                @if (!string.IsNullOrEmpty(Model.ContactPerson))
                {
                    <div class="col-md-4">
                        <small class="text-muted d-block">Người liên hệ</small>
                        <strong>@Model.ContactPerson</strong>
                    </div>
                }
                @if (!string.IsNullOrEmpty(Model.ContactEmail))
                {
                    <div class="col-md-4">
                        <small class="text-muted d-block">Email</small>
                        <strong>@Model.ContactEmail</strong>
                    </div>
                }
                @if (!string.IsNullOrEmpty(Model.ContactPhone))
                {
                    <div class="col-md-4">
                        <small class="text-muted d-block">Điện thoại</small>
                        <strong>@Model.ContactPhone</strong>
                    </div>
                }
            </div>
        </div>

        <!-- Meta Info -->
        <div class="border-top pt-3">
            <div class="row g-2 small text-muted">
                <div class="col-md-4">
                    <i class="bi bi-calendar-plus me-1"></i>
                    Đăng ngày: <strong>@Model.CreatedAt.ToString("dd/MM/yyyy")</strong>
                </div>
                @if (Model.Deadline.HasValue)
                {
                    <div class="col-md-4">
                        <i class="bi bi-calendar-x me-1"></i>
                        Hạn nộp: <strong>@Model.Deadline.Value.ToString("dd/MM/yyyy")</strong>
                    </div>
                }
                <div class="col-md-4">
                    <i class="bi bi-eye me-1"></i>
                    Lượt xem: <strong>@Model.ViewCount.ToString("N0")</strong>
                </div>
            </div>
        </div>
    </div>

    <div class="d-flex justify-content-end gap-2 mt-4 pt-3 border-top">
        <button type="button" class="btn btn-light px-4 rounded-3" data-bs-dismiss="modal">Đóng</button>
        <button type="button" class="btn btn-primary px-4 rounded-3" onclick="openEditFromDetails(@Model.JobId)">
            <i class="bi bi-pencil me-1"></i>Chỉnh Sửa
        </button>
    </div>
</div>

<script>
    function openEditFromDetails(id) {
        const currentModal = bootstrap.Modal.getInstance(document.getElementById('modalJob'));
        if (currentModal) currentModal.hide();
        setTimeout(() => { openEditModal(id); }, 300);
    }
</script>