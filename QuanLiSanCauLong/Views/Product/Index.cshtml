@model QuanLiSanCauLong.ViewModels.ProductListViewModel
@{
    ViewData["Title"] = "Cửa hàng thể thao";
}

<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Noto+Sans+JP:wght@300;400;700&family=Barlow+Condensed:ital,wght@0,400;0,600;0,700;1,700&display=swap" rel="stylesheet">

<style>
    :root {
        --bg: #f0ede8;
        --ink: #111111;
        --red: #e8201a;
        --tan: #d4c5b0;
        --warm: #e8e0d4;
        --muted: #7a7068;
        --white: #faf9f7;
    }

    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }

    .shop-page {
        background: var(--bg);
        font-family: 'Noto Sans JP', sans-serif;
        color: var(--ink);
        min-height: 100vh;
        overflow-x: hidden;
    }

    /* ── HERO ─────────────────────────────────────── */
    .shop-hero {
        background: var(--ink);
        position: relative;
        overflow: hidden;
        padding: 0;
    }

    .hero-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        min-height: 70vh;
    }

    .hero-left {
        padding: 5rem 4rem;
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        position: relative;
        z-index: 2;
    }

    .hero-label {
        font-family: 'Barlow Condensed', sans-serif;
        font-size: .78rem;
        letter-spacing: .25em;
        text-transform: uppercase;
        color: var(--red);
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: .75rem;
    }

        .hero-label::before {
            content: '';
            display: block;
            width: 24px;
            height: 2px;
            background: var(--red);
        }

    .hero-big {
        font-family: 'Bebas Neue', sans-serif;
        font-size: clamp(5rem, 10vw, 11rem);
        line-height: .9;
        color: var(--white);
        letter-spacing: -.01em;
        margin-bottom: 1.5rem;
    }

        .hero-big .red-line {
            color: var(--red);
            display: block;
        }

    .hero-sub {
        font-size: .9rem;
        color: rgba(255,255,255,.45);
        font-weight: 300;
        max-width: 320px;
        line-height: 1.8;
        letter-spacing: .05em;
    }

    .hero-right {
        position: relative;
        overflow: hidden;
    }

    .hero-right-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        filter: grayscale(30%) contrast(1.1);
        mix-blend-mode: luminosity;
        opacity: .6;
    }

    .hero-right::after {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(to left, transparent, var(--ink) 70%);
    }

    .hero-counter-bar {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--red);
        display: flex;
        z-index: 10;
    }

    .hcounter {
        flex: 1;
        padding: 1.2rem 2rem;
        border-right: 1px solid rgba(255,255,255,.2);
        text-align: center;
    }

        .hcounter:last-child {
            border-right: none;
        }

    .hcounter-n {
        font-family: 'Bebas Neue', sans-serif;
        font-size: 2.2rem;
        line-height: 1;
        color: #fff;
    }

    .hcounter-l {
        font-size: .65rem;
        letter-spacing: .15em;
        text-transform: uppercase;
        color: rgba(255,255,255,.7);
        margin-top: .2rem;
        font-family: 'Barlow Condensed', sans-serif;
    }

    /* ── SEARCH + FILTER BAR ──────────────────────── */
    .control-bar {
        background: var(--ink);
        padding: 1.5rem 4rem;
        display: flex;
        align-items: center;
        gap: 2rem;
        position: sticky;
        top: 0;
        z-index: 100;
    }

    .search-wrap {
        flex: 1;
        max-width: 400px;
        position: relative;
    }

    .search-input {
        width: 100%;
        background: rgba(255,255,255,.08);
        border: 1px solid rgba(255,255,255,.15);
        border-radius: 0;
        padding: .75rem 1rem .75rem 3rem;
        color: #fff;
        font-family: 'Noto Sans JP', sans-serif;
        font-size: .88rem;
        outline: none;
        transition: border-color .2s;
    }

        .search-input::placeholder {
            color: rgba(255,255,255,.35);
        }

        .search-input:focus {
            border-color: var(--red);
            background: rgba(255,255,255,.12);
        }

    .search-icon {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: rgba(255,255,255,.4);
        font-size: .9rem;
    }

    .cat-tabs {
        display: flex;
        gap: 0;
        overflow-x: auto;
        scrollbar-width: none;
    }

        .cat-tabs::-webkit-scrollbar {
            display: none;
        }

    .ctab {
        padding: .6rem 1.4rem;
        border: 1px solid rgba(255,255,255,.15);
        border-right: none;
        background: none;
        color: rgba(255,255,255,.5);
        font-family: 'Barlow Condensed', sans-serif;
        font-size: .82rem;
        font-weight: 600;
        letter-spacing: .1em;
        text-transform: uppercase;
        cursor: pointer;
        transition: all .2s;
        white-space: nowrap;
    }

        .ctab:last-child {
            border-right: 1px solid rgba(255,255,255,.15);
        }

        .ctab:hover {
            color: #fff;
            background: rgba(255,255,255,.06);
        }

        .ctab.active {
            background: var(--red);
            color: #fff;
            border-color: var(--red);
        }

    /* ── CATEGORY SECTION ─────────────────────────── */
    .shop-body {
        padding: 4rem;
    }

    .cat-section {
        margin-bottom: 5rem;
    }

    .cat-header {
        display: flex;
        align-items: baseline;
        gap: 1.5rem;
        margin-bottom: 2.5rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--ink);
    }

    .cat-title {
        font-family: 'Bebas Neue', sans-serif;
        font-size: 3rem;
        line-height: 1;
        letter-spacing: .02em;
        color: var(--ink);
    }

    .cat-count {
        font-family: 'Barlow Condensed', sans-serif;
        font-size: .8rem;
        letter-spacing: .15em;
        text-transform: uppercase;
        color: var(--muted);
    }

    /* ── PRODUCT GRID ─────────────────────────────── */
    .products-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1px;
        background: var(--tan);
    }

    /* ── PRODUCT CARD ─────────────────────────────── */
    .prod-card {
        background: var(--white);
        cursor: pointer;
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        transition: all .3s cubic-bezier(.25,.46,.45,.94);
    }

        .prod-card:hover {
            background: var(--ink);
        }

    .prod-thumb {
        height: 260px;
        position: relative;
        overflow: hidden;
        background: var(--warm);
    }

        .prod-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform .6s cubic-bezier(.25,.46,.45,.94);
        }

    .prod-card:hover .prod-thumb img {
        transform: scale(1.08);
    }

    .no-img {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--warm);
        font-size: 4rem;
        color: var(--tan);
    }

    .prod-badge {
        position: absolute;
        top: 0;
        left: 0;
        background: var(--red);
        color: #fff;
        font-family: 'Barlow Condensed', sans-serif;
        font-size: .7rem;
        font-weight: 700;
        letter-spacing: .12em;
        padding: .3rem .8rem;
        text-transform: uppercase;
    }

    .prod-body {
        padding: 1.5rem;
        flex: 1;
        display: flex;
        flex-direction: column;
        transition: all .3s;
    }

    .prod-brand {
        font-family: 'Barlow Condensed', sans-serif;
        font-size: .72rem;
        letter-spacing: .15em;
        text-transform: uppercase;
        color: var(--muted);
        margin-bottom: .4rem;
        transition: color .3s;
    }

    .prod-card:hover .prod-brand {
        color: rgba(255,255,255,.4);
    }

    .prod-name {
        font-family: 'Barlow Condensed', sans-serif;
        font-size: 1.15rem;
        font-weight: 700;
        line-height: 1.25;
        color: var(--ink);
        margin-bottom: .5rem;
        flex: 1;
        transition: color .3s;
    }

    .prod-card:hover .prod-name {
        color: #fff;
    }

    .prod-footer {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid var(--warm);
        transition: border-color .3s;
    }

    .prod-card:hover .prod-footer {
        border-color: rgba(255,255,255,.1);
    }

    .prod-price {
        font-family: 'Bebas Neue', sans-serif;
        font-size: 1.5rem;
        line-height: 1;
        color: var(--ink);
        transition: color .3s;
    }

    .prod-card:hover .prod-price {
        color: var(--red);
    }

    .prod-old {
        font-size: .75rem;
        text-decoration: line-through;
        color: var(--muted);
        margin-top: .15rem;
        transition: color .3s;
    }

    .prod-card:hover .prod-old {
        color: rgba(255,255,255,.3);
    }

    .add-btn {
        width: 38px;
        height: 38px;
        border-radius: 50%;
        background: var(--bg);
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all .3s;
        font-size: .95rem;
        color: var(--ink);
        flex-shrink: 0;
    }

    .prod-card:hover .add-btn {
        background: var(--red);
        color: #fff;
        transform: rotate(90deg);
    }

    /* ── EMPTY STATE ──────────────────────────────── */
    .empty-state {
        grid-column: 1 / -1;
        background: var(--white);
        padding: 5rem;
        text-align: center;
    }

    .empty-state-icon {
        font-family: 'Bebas Neue', sans-serif;
        font-size: 5rem;
        line-height: 1;
        color: var(--tan);
        margin-bottom: 1rem;
    }

    .empty-state p {
        color: var(--muted);
        font-size: .9rem;
        letter-spacing: .05em;
    }

    /* ── RESPONSIVE ───────────────────────────────── */
    @@media (max-width: 1200px) {
        .products-grid {
            grid-template-columns: repeat(3, 1fr);
        }
    }
    @@media (max-width: 900px) {
        .hero-grid {
            grid-template-columns: 1fr;
            min-height: auto;
        }

        .hero-right {
            display: none;
        }

        .hero-left {
            padding: 4rem 2rem 5rem;
        }

        .control-bar {
            padding: 1.2rem 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .shop-body {
            padding: 2.5rem 1.5rem;
        }

        .products-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .cat-title {
            font-size: 2.2rem;
        }
    }
    @@media (max-width: 540px) {
        .products-grid {
            grid-template-columns: 1fr;
        }

        .hero-big {
            font-size: 5rem;
        }

        .hcounter {
            padding: 1rem;
        }
    }
</style>

<div class="shop-page">

    <!-- HERO -->
    <section class="shop-hero">
        <div class="hero-grid">
            <div class="hero-left">
                <div class="hero-label">Badminton Pro Store</div>
                <h1 class="hero-big">
                    Sport
                    <span class="red-line">Shop.</span>
                </h1>
                <p class="hero-sub">Dụng cụ thi đấu chuyên nghiệp. Vợt, giày, phụ kiện chính hãng từ các thương hiệu hàng đầu thế giới.</p>
            </div>
            <div class="hero-right">
                <img class="hero-right-img" src="https://images.unsplash.com/photo-1552072092-7f9b8d63efcb?w=900&q=80" alt="Sport shop" />
            </div>
        </div>
        <div class="hero-counter-bar">
            <div class="hcounter">
                <div class="hcounter-n">@Model.Categories.Sum(c => c.Products.Count())</div>
                <div class="hcounter-l">Sản phẩm</div>
            </div>
            <div class="hcounter">
                <div class="hcounter-n">@Model.Categories.Count()</div>
                <div class="hcounter-l">Danh mục</div>
            </div>
            <div class="hcounter">
                <div class="hcounter-n">100%</div>
                <div class="hcounter-l">Chính hãng</div>
            </div>
            <div class="hcounter">
                <div class="hcounter-n">24H</div>
                <div class="hcounter-l">Giao hàng</div>
            </div>
        </div>
    </section>

    <!-- CONTROL BAR -->
    <div class="control-bar">
        <form asp-action="Index" method="get" class="search-wrap">
            <i class="bi bi-search search-icon"></i>
            <input type="text" name="search" class="search-input"
                   placeholder="Tìm vợt, giày, phụ kiện..."
                   value="@Model.SearchKeyword" />
        </form>
        <div class="cat-tabs">
            <button class="ctab active" data-target="all">TẤT CẢ</button>
            @foreach (var cat in Model.Categories)
            {
                <button class="ctab" data-target="cat-@cat.CategoryId">@cat.CategoryName.ToUpper()</button>
            }
        </div>
    </div>

    <!-- PRODUCTS -->
    <div class="shop-body">
        <!-- ALL VIEW -->
        <div id="view-all">
            @if (!Model.Categories.Any() || !Model.Categories.Any(c => c.Products.Any()))
            {
                <div class="products-grid">
                    <div class="empty-state">
                        <div class="empty-state-icon">404</div>
                        <p>Không tìm thấy sản phẩm nào phù hợp</p>
                    </div>
                </div>
            }
            else
            {
                @foreach (var catGroup in Model.Categories)
                {
                    if (catGroup.Products.Any())
                    {
                        <div class="cat-section" id="cat-@catGroup.CategoryId">
                            <div class="cat-header">
                                <div class="cat-title">@catGroup.CategoryName</div>
                                <div class="cat-count">@catGroup.Products.Count() items</div>
                            </div>
                            <div class="products-grid">
                                @foreach (var product in catGroup.Products)
                                {
                                    <div class="prod-card">
                                        <div class="prod-thumb">
                                            @if (!string.IsNullOrEmpty(product.ImageUrl))
                                            {
                                                <img src="@product.ImageUrl" alt="@product.ProductName" />
                                            }
                                            else
                                            {
                                                <div class="no-img"><i class="bi bi-bag"></i></div>
                                            }
                                            @if (product.DiscountPrice.HasValue && product.DiscountPrice < product.Price)
                                            {
                                                <div class="prod-badge">SALE</div>
                                            }
                                        </div>
                                        <div class="prod-body">
                                            <div class="prod-brand">@(catGroup.CategoryName)</div>
                                            <div class="prod-name">@product.ProductName</div>
                                            <div class="prod-footer">
                                                <div>
                                                    <div class="prod-price">
                                                        @((product.DiscountPrice ?? product.Price).ToString("N0"))đ
                                                    </div>
                                                    @if (product.DiscountPrice.HasValue && product.DiscountPrice < product.Price)
                                                    {
                                                        <div class="prod-old">@product.Price.ToString("N0")đ</div>
                                                    }
                                                </div>
                                                <button class="add-btn" title="Thêm vào giỏ">
                                                    <i class="bi bi-plus-lg"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                    }
                }
            }
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Category tab switching
        const tabs = document.querySelectorAll('.ctab');
        const catSections = document.querySelectorAll('.cat-section');

        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                tabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                const target = this.dataset.target;
                if (target === 'all') {
                    catSections.forEach(s => s.style.display = '');
                } else {
                    catSections.forEach(s => {
                        s.style.display = s.id === target ? '' : 'none';
                    });
                }
            });
        });

        // Search on Enter
        document.querySelector('.search-input')?.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') this.closest('form').submit();
        });
    </script>
}
