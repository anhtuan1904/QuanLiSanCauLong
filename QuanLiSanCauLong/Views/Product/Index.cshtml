@model QuanLiSanCauLong.ViewModels.ProductListViewModel
@{
    ViewData["Title"] = "Cửa hàng thể thao";
}

<style>
    :root {
        --deep: #1a1209;
        --deep2: #231a0e;
        --deep3: #2e2110;
        --gold: #d4a017;
        --gold2: #f5c842;
        --gold3: rgba(212,160,23,.1);
        --warm: #f5ede0;
        --cream: #fdf8f0;
        --ink: #1a1209;
        --border: rgba(212,160,23,.2);
        --muted: rgba(255,255,255,.38);
    }

    .shop-page {
        background: var(--warm);
        min-height: 100vh;
        font-family: 'Outfit',sans-serif;
        color: var(--ink);
        overflow-x: hidden;
    }
    /* HERO */
    .shop-hero {
        background: var(--deep);
        position: relative;
        overflow: hidden;
    }

        .shop-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg,var(--gold),var(--gold2),transparent);
            z-index: 5;
        }

    .hero-noise {
        position: absolute;
        inset: 0;
        pointer-events: none;
        z-index: 1;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.04'/%3E%3C/svg%3E");
    }

    .hero-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        min-height: 68vh;
        position: relative;
        z-index: 2;
    }

    .hero-left {
        padding: 5rem 4rem 7rem;
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
    }

    .hero-eyebrow {
        display: inline-flex;
        align-items: center;
        gap: .6rem;
        font-size: .72rem;
        font-weight: 700;
        letter-spacing: .22em;
        text-transform: uppercase;
        color: var(--gold);
        margin-bottom: 1.2rem;
    }

        .hero-eyebrow::before {
            content: '';
            width: 26px;
            height: 2px;
            background: var(--gold);
            display: block;
        }

    .hero-big {
        font-family: 'Playfair Display',serif;
        font-size: clamp(4rem,8vw,8rem);
        font-weight: 700;
        line-height: .95;
        color: #fff;
        margin-bottom: 1.5rem;
    }

        .hero-big em {
            color: var(--gold2);
            font-style: italic;
            display: block;
        }

    .hero-sub {
        font-size: .9rem;
        color: rgba(255,255,255,.42);
        line-height: 1.85;
        max-width: 320px;
    }

    .hero-right {
        position: relative;
        overflow: hidden;
    }

        .hero-right img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: .4;
            filter: grayscale(25%);
        }

        .hero-right::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to left,transparent 15%,var(--deep) 72%);
        }

    .hero-stat-bar {
        background: var(--gold);
        display: flex;
        position: relative;
        z-index: 2;
    }

    .hstat {
        flex: 1;
        padding: 1.1rem 1.5rem;
        border-right: 1px solid rgba(26,18,9,.18);
        text-align: center;
    }

        .hstat:last-child {
            border-right: none;
        }

    .hstat-n {
        font-family: 'Playfair Display',serif;
        font-size: 2rem;
        font-weight: 700;
        color: var(--deep);
        line-height: 1;
    }

    .hstat-l {
        font-size: .62rem;
        font-weight: 700;
        letter-spacing: .16em;
        text-transform: uppercase;
        color: rgba(26,18,9,.55);
        margin-top: .2rem;
    }
    /* CTRL */
    .ctrl-bar {
        background: var(--deep2);
        border-bottom: 1px solid var(--border);
        padding: 1.1rem 3rem;
        display: flex;
        align-items: center;
        gap: 1.5rem;
        position: sticky;
        top: 64px;
        z-index: 99;
    }

    .ctrl-search {
        flex: 1;
        max-width: 340px;
        position: relative;
    }

    .ctrl-input {
        width: 100%;
        background: rgba(255,255,255,.06);
        border: 1.5px solid var(--border);
        border-radius: 5px;
        padding: .65rem .9rem .65rem 2.4rem;
        color: #fff;
        font-family: 'Outfit',sans-serif;
        font-size: .86rem;
        outline: none;
        transition: all .2s;
    }

        .ctrl-input::placeholder {
            color: rgba(255,255,255,.22);
        }

        .ctrl-input:focus {
            border-color: var(--gold);
            background: rgba(212,160,23,.07);
        }

    .ctrl-icon {
        position: absolute;
        left: .8rem;
        top: 50%;
        transform: translateY(-50%);
        color: rgba(255,255,255,.28);
        font-size: .82rem;
        pointer-events: none;
    }

    .cat-tabs {
        display: flex;
        overflow-x: auto;
        scrollbar-width: none;
    }

        .cat-tabs::-webkit-scrollbar {
            display: none;
        }

    .ctab {
        padding: .55rem 1.2rem;
        border: 1.5px solid var(--border);
        border-right: none;
        background: none;
        color: rgba(255,255,255,.42);
        font-family: 'Outfit',sans-serif;
        font-size: .76rem;
        font-weight: 700;
        letter-spacing: .1em;
        text-transform: uppercase;
        cursor: pointer;
        transition: all .2s;
        white-space: nowrap;
    }

        .ctab:last-child {
            border-right: 1.5px solid var(--border);
        }

        .ctab:hover {
            color: var(--gold2);
            background: var(--gold3);
        }

        .ctab.active {
            background: var(--gold);
            color: var(--deep);
            border-color: var(--gold);
        }
    /* BODY */
    .shop-body {
        padding: 3.5rem 3rem 5rem;
    }

    .cat-section {
        margin-bottom: 5rem;
    }

    .cat-header {
        display: flex;
        align-items: baseline;
        gap: 1.25rem;
        margin-bottom: 2rem;
        padding-bottom: .85rem;
        border-bottom: 2px solid var(--ink);
    }

    .cat-title {
        font-family: 'Playfair Display',serif;
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--ink);
    }

    .cat-count {
        font-size: .7rem;
        font-weight: 700;
        letter-spacing: .15em;
        text-transform: uppercase;
        color: rgba(26,18,9,.3);
    }
    /* GRID */
    .products-grid {
        display: grid;
        grid-template-columns: repeat(4,1fr);
        gap: 1.5px;
        background: rgba(26,18,9,.12);
    }
    /* CARD = <a> */
    .prod-card {
        background: var(--cream);
        cursor: pointer;
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        transition: all .32s cubic-bezier(.25,.46,.45,.94);
        text-decoration: none;
        color: inherit;
    }

        .prod-card:hover {
            background: var(--deep);
            transform: translateY(-5px);
            box-shadow: 0 28px 55px rgba(26,18,9,.35);
            z-index: 3;
        }

    .prod-thumb {
        height: 260px;
        position: relative;
        overflow: hidden;
        background: var(--warm);
        flex-shrink: 0;
    }

        .prod-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform .6s cubic-bezier(.25,.46,.45,.94);
        }

    .prod-card:hover .prod-thumb img {
        transform: scale(1.08);
    }

    .no-img {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 4rem;
        color: rgba(212,160,23,.2);
    }

    .prod-sale-tag {
        position: absolute;
        top: 0;
        left: 0;
        background: #c94b2a;
        color: #fff;
        font-size: .62rem;
        font-weight: 800;
        letter-spacing: .14em;
        text-transform: uppercase;
        padding: .3rem .85rem;
        z-index: 2;
    }
    /* hover overlay */
    .prod-hover-eye {
        position: absolute;
        inset: 0;
        background: rgba(26,18,9,.6);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: .55rem;
        opacity: 0;
        transition: opacity .28s;
        z-index: 4;
    }

    .prod-card:hover .prod-hover-eye {
        opacity: 1;
    }

    .eye-pill {
        background: var(--gold);
        color: var(--deep);
        border-radius: 3px;
        padding: .55rem 1.2rem;
        font-family: 'Outfit',sans-serif;
        font-size: .78rem;
        font-weight: 800;
        letter-spacing: .07em;
        text-transform: uppercase;
        display: flex;
        align-items: center;
        gap: .4rem;
    }

    .eye-hint {
        font-size: .67rem;
        color: rgba(255,255,255,.45);
        letter-spacing: .04em;
    }

    .prod-body {
        padding: 1.25rem 1.4rem;
        flex: 1;
        display: flex;
        flex-direction: column;
    }

    .prod-cat {
        font-size: .63rem;
        font-weight: 700;
        letter-spacing: .15em;
        text-transform: uppercase;
        color: rgba(26,18,9,.35);
        margin-bottom: .35rem;
        transition: color .3s;
    }

    .prod-card:hover .prod-cat {
        color: rgba(255,255,255,.3);
    }

    .prod-name {
        font-family: 'Playfair Display',serif;
        font-size: 1rem;
        font-weight: 700;
        color: var(--ink);
        line-height: 1.3;
        flex: 1;
        margin-bottom: .6rem;
        transition: color .3s;
    }

    .prod-card:hover .prod-name {
        color: #fff;
    }

    .prod-footer {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding-top: .85rem;
        border-top: 1px solid rgba(26,18,9,.08);
        transition: border-color .3s;
    }

    .prod-card:hover .prod-footer {
        border-color: rgba(255,255,255,.1);
    }

    .prod-price {
        font-family: 'Playfair Display',serif;
        font-size: 1.4rem;
        font-weight: 700;
        color: var(--ink);
        line-height: 1;
        transition: color .3s;
    }

    .prod-card:hover .prod-price {
        color: var(--gold2);
    }

    .prod-old {
        font-size: .7rem;
        text-decoration: line-through;
        color: rgba(26,18,9,.3);
        margin-top: .1rem;
        transition: color .3s;
    }

    .prod-card:hover .prod-old {
        color: rgba(255,255,255,.2);
    }

    .add-btn {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background: var(--warm);
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all .3s;
        font-size: .88rem;
        color: var(--ink);
        flex-shrink: 0;
    }

    .prod-card:hover .add-btn {
        background: var(--gold);
        color: var(--deep);
        transform: rotate(90deg);
    }

    .empty-state {
        grid-column: 1/-1;
        background: var(--cream);
        padding: 5rem;
        text-align: center;
    }

    .empty-title {
        font-family: 'Playfair Display',serif;
        font-size: 5rem;
        font-weight: 700;
        color: rgba(26,18,9,.1);
        margin-bottom: 1rem;
    }

    .empty-state p {
        color: rgba(26,18,9,.35);
        font-size: .9rem;
    }

    @@media(max-width:1200px) {
        .products-grid {
            grid-template-columns: repeat(3,1fr);
        }
    }

    @@media(max-width:900px) {
        .hero-grid {
            grid-template-columns: 1fr;
            min-height: auto;
        }

        .hero-right {
            display: none;
        }

        .hero-left {
            padding: 4rem 2rem 6rem;
        }

        .ctrl-bar {
            padding: 1rem 1.5rem;
            flex-wrap: wrap;
            gap: .75rem;
            top: 0;
        }

        .shop-body {
            padding: 2.5rem 1.5rem 4rem;
        }

        .products-grid {
            grid-template-columns: repeat(2,1fr);
        }
    }

    @@media(max-width:540px) {
        .products-grid {
            grid-template-columns: 1fr;
        }
    }
</style>

<div class="shop-page">
    <section class="shop-hero">
        <div class="hero-noise"></div>
        <div class="hero-grid">
            <div class="hero-left">
                <div class="hero-eyebrow">Badminton Pro Store</div>
                <h1 class="hero-big">Sport<em>Shop.</em></h1>
                <p class="hero-sub">Dụng cụ thi đấu chuyên nghiệp. Vợt, giày, phụ kiện chính hãng từ các thương hiệu hàng đầu thế giới.</p>
            </div>
            <div class="hero-right">
                <img src="https://images.unsplash.com/photo-1552072092-7f9b8d63efcb?w=900&q=80" alt="" />
            </div>
        </div>
        <div class="hero-stat-bar">
            <div class="hstat"><div class="hstat-n">@Model.Categories.Sum(c => c.Products.Count())</div><div class="hstat-l">Sản phẩm</div></div>
            <div class="hstat"><div class="hstat-n">@Model.Categories.Count()</div><div class="hstat-l">Danh mục</div></div>
            <div class="hstat"><div class="hstat-n">100%</div><div class="hstat-l">Chính hãng</div></div>
            <div class="hstat"><div class="hstat-n">24H</div><div class="hstat-l">Giao hàng</div></div>
        </div>
    </section>

    <div class="ctrl-bar">
        <form asp-action="Index" method="get" class="ctrl-search">
            <i class="bi bi-search ctrl-icon"></i>
            <input type="text" name="search" class="ctrl-input" placeholder="Tìm vợt, giày, phụ kiện..." value="@Model.SearchKeyword" />
        </form>
        <div class="cat-tabs">
            <button class="ctab active" data-target="all">TẤT CẢ</button>
            @foreach (var cat in Model.Categories)
            {
                <button class="ctab" data-target="cat-@cat.CategoryId">@cat.CategoryName.ToUpper()</button>
            }
        </div>
    </div>

    <div class="shop-body">
        @if (!Model.Categories.Any() || !Model.Categories.Any(c => c.Products.Any()))
        {
            <div class="products-grid">
                <div class="empty-state">
                    <div class="empty-title">404</div>
                    <p>Không tìm thấy sản phẩm nào phù hợp</p>
                </div>
            </div>
        }
        else
        {
            @foreach (var catGroup in Model.Categories)
            {
                if (catGroup.Products.Any())
                {
                    <div class="cat-section" id="cat-@catGroup.CategoryId">
                        <div class="cat-header">
                            <div class="cat-title">@catGroup.CategoryName</div>
                            <div class="cat-count">@catGroup.Products.Count() items</div>
                        </div>
                        <div class="products-grid">
                            @foreach (var product in catGroup.Products)
                            {
                                /* ── ENTIRE CARD IS AN ANCHOR LINK TO DETAILS ── */
                                <a class="prod-card" asp-action="Details" asp-route-id="@product.ProductId">
                                    <div class="prod-thumb">
                                        @if (!string.IsNullOrEmpty(product.ImageUrl))
                                        {
                                            <img src="@product.ImageUrl" alt="@product.ProductName" />
                                        }
                                        else
                                        {
                                            <div class="no-img"><i class="bi bi-bag"></i></div>
                                        }
                                        @if (product.DiscountPrice.HasValue && product.DiscountPrice < product.Price)
                                        {
                                            <div class="prod-sale-tag">SALE</div>
                                        }
                                        <div class="prod-hover-eye">
                                            <div class="eye-pill"><i class="bi bi-eye"></i> Xem chi tiết</div>
                                            <div class="eye-hint">Click để xem sản phẩm</div>
                                        </div>
                                    </div>
                                    <div class="prod-body">
                                        <div class="prod-cat">@catGroup.CategoryName</div>
                                        <div class="prod-name">@product.ProductName</div>
                                        <div class="prod-footer">
                                            <div>
                                                <div class="prod-price">@((product.DiscountPrice ?? product.Price).ToString("N0"))đ</div>
                                                @if (product.DiscountPrice.HasValue && product.DiscountPrice < product.Price)
                                                {
                                                    <div class="prod-old">@product.Price.ToString("N0")đ</div>
                                                }
                                            </div>
                                            <button class="add-btn" onclick="event.preventDefault()" title="Thêm vào giỏ">
                                                <i class="bi bi-plus-lg"></i>
                                            </button>
                                        </div>
                                    </div>
                                </a>
                            }
                        </div>
                    </div>
                }
            }
        }
    </div>
</div>

@section Scripts {
    <script>
        const tabs = document.querySelectorAll('.ctab');
        const sections = document.querySelectorAll('.cat-section');
        tabs.forEach(tab => {
            tab.addEventListener('click', function () {
                tabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                const t = this.dataset.target;
                sections.forEach(s => s.style.display = t === 'all' || s.id === t ? '' : 'none');
            });
        });
        document.querySelector('.ctrl-input')?.addEventListener('keydown', e => {
            if (e.key === 'Enter') e.target.closest('form').submit();
        });
    </script>
}
